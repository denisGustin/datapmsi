<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Data PMSI</title>
<link>https://www.datapmsi.com/</link>
<atom:link href="https://www.datapmsi.com/index.xml" rel="self" type="application/rss+xml"/>
<description>Codes et formations R pour les PMSI MCO, SMR, PSY et HAD</description>
<generator>quarto-1.4.551</generator>
<lastBuildDate>Mon, 10 Jun 2024 22:00:00 GMT</lastBuildDate>
<item>
  <title>IPDMS par GHM</title>
  <dc:creator>denis Gustin</dc:creator>
  <link>https://www.datapmsi.com/posts/mco/script_mco_ipdms_ghm/</link>
  <description><![CDATA[ 




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>On se restreint aux séjours de sévérité 1,2,3 ou 4 d’au moins 1 nuitée et on suppose qu’on est en ex-DGF</p>
<p>Pour chaque séjour, on rapatrie la DMS OVALIDE correspondant à son GHM et à son année PMSI, à partir du référentiel annualisé OVALIDE GHMinfo <sup>1</sup></p>
<p>Pour ces séjours, pour chaque GHM, on calcule le nombre de séjours, le cumul des JP de ces séjours et l’IPDMS au sens “division du nombre de journées de l’établissement par le nombre de journées théoriques pour le périmètre considéré.”</p>
</section>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">Code</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(refpmsi)</span>
<span id="cb1-3"></span>
<span id="cb1-4">ovalide_ghminfo_dgf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> refpmsi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">refpmsi</span>(ovalide_ghminfo_dgf)</span>
<span id="cb1-5"></span>
<span id="cb1-6">casemix_ghm_ipdms <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mco<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rum<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rum <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-7">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(annee_import,nas,ghm,severite,date_entree_um,date_sortie_um) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-8">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> nas, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_entree_sejour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(date_entree_um), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_sortie_sejour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(date_sortie_um),</span>
<span id="cb1-9">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_jp_sejour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.integer</span>(date_sortie_sejour<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>date_entree_sejour)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-10">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distinct</span>(nas,ghm,severite,date_sortie_sejour,nb_jp_sejour) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-11">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">annee_sortie_sejour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(lubridate<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">year</span>(date_sortie_sejour))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-12">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(severite <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"4"</span>), nb_jp_sejour <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>L) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-13">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(ovalide_ghminfo_dgf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(annee_pmsi,ghm,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dms_ovalide_ghm =</span> dms),</span>
<span id="cb1-14">                     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(ghm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> ghm, annee_sortie_sejour <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> annee_pmsi)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-15">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_jp_theorique_sejour =</span> dms_ovalide_ghm<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>nb_jp_sejour) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-16">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(ghm) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-17">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_sejour_ghm =</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb1-18">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_jp_sejour_ghm =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(nb_jp_sejour),</span>
<span id="cb1-19">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_jp_theorique_ghm =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(nb_jp_theorique_sejour)</span>
<span id="cb1-20">                     ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-21">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ipdms_ghm =</span> nb_jp_sejour_ghm<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>nb_jp_theorique_ghm)</span>
<span id="cb1-22">casemix_ghm_ipdms</span></code></pre></div>
</div>
</section>
<section id="commentaires" class="level2">
<h2 class="anchored" data-anchor-id="commentaires">Commentaires</h2>
<p>Ligne 8-9 : voir script “Nombre de JP d’un séjour MCO” pour le calcul de <code>nb_jp_sejour</code></p>
<p>Ligne 11 : forçage <code>annee_sortie_sejour</code> en character pour préparer la jointure avec <code>ovalide_ghminfo_dgf</code></p>
<p>Pour aller + loin :<br>
Calcul de l’écart à la moyenne en nb_jp avec nb_jp_theorique_ghm<br>
Rapatriemeent libellé des GHM<br>
Etc …</p>
<p>PMSISoft MCO Professionnel : IPDMS calculée pour tous les casemix en CMD, sous-CMD, RGHM, GHM, Sévérité, DA, GA, GP. <code>ipdms_ghm</code>dans <code>mco</code></p>
<p><a href="http://www.lespmsi.com/scripts-pmsi-r/" target="_blank">Etre tenu au courant de la publication des nouveaux scripts PMSI R</a></p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Notes de bas de page</h2>

<ol>
<li id="fn1"><p>Documentation du référentiel <a href="https://denisgustin.github.io/refpmsi/articles/ghm.html#ovalide---table-ghminfo_exdgf" target="_blank">ovalide_ghminfo_dgf</a>↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>MCO</category>
  <category>GHM</category>
  <category>Casemix</category>
  <guid>https://www.datapmsi.com/posts/mco/script_mco_ipdms_ghm/</guid>
  <pubDate>Mon, 10 Jun 2024 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Episodes de soin continu par IPP</title>
  <dc:creator>denis Gustin</dc:creator>
  <link>https://www.datapmsi.com/posts/psy/script_psy_episode_soin_continu/</link>
  <description><![CDATA[ 




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Pour la définition des épisodes de soin continu en hospitalisation complète, voir <a href="https://www.scansante.fr/sites/default/files/content/376/notice_rme_psy_hospitalisations_longues_en_psychiatrie.pdf" target="_blank">ici</a></p>
<p>Dans une première étape, sur la base des RPS de temps complet, on repère et comptabilise par IPP, les épisodes de soin continu.</p>
<p>Dans une 2eme étape, on passe en IPP et on calcule le nombre de séjours de l’IPP.</p>
<p>Au final, on a un tibble par IPP avec, pour chaque IPP, le nombre de séjours temps complet et le nombre d’épisodes soin continu.</p>
</section>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">Code</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"></span>
<span id="cb1-3">rps_episode_soin_continu <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> psy<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-4">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(forme_activite,ipp,no_sejour,date_debut_sequence,date_fin_sequence,nb_jours_presence) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-5">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(forme_activite <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01D"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01S"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01P"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"02"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"03"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"04"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"05"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"06"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"07"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-6">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(ipp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-7">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(date_debut_sequence, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by_group =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-8">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">same_episode_soin_continu_ipp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.integer</span>(date_debut_sequence<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(date_fin_sequence, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> date_debut_sequence[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>L,</span>
<span id="cb1-9">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cumsum_episode_soin_continu_ipp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>same_episode_soin_continu_ipp)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>L,</span>
<span id="cb1-10">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_episode_soin_continu_ipp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(cumsum_episode_soin_continu_ipp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-11">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>()</span>
<span id="cb1-12">rps_episode_soin_continu</span>
<span id="cb1-13"></span>
<span id="cb1-14">ipp_episode_soin_continu <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rps_episode_soin_continu <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-15">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distinct</span>(ipp,no_sejour,nb_episode_soin_continu_ipp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-16">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> ipp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_sejour_ipp =</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-17">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distinct</span>(ipp,nb_sejour_ipp,nb_episode_soin_continu_ipp)</span>
<span id="cb1-18">ipp_episode_soin_continu</span></code></pre></div>
</div>
</section>
<section id="commentaires" class="level2">
<h2 class="anchored" data-anchor-id="commentaires">Commentaires</h2>
<p>Ligne 7 : l’argument <code>.by_group = TRUE</code> dans le <code>dplyr::arrange()</code> permet de trier au sein d’un regroupement.</p>
<p>Ligne 9 : le +1L est là pour faire démarrer le comptage des épisodes de soin continu à 1 et non à 0</p>
<p>Pour aller + loin :<br>
Repérage concomitant des épisodes de soin concentré (séquences séparées de 0 à 7 jours dans un même épisode)<br>
Attribution d’un code aux épisodes de soin continu</p>
<p>PMSISoft PSY Standard :voir écran <code>Séjours &gt; Base des séjours</code>, affichage du nombre d’épisodes de soin continu et du nombre d’épisodes de soin concentré au dessus du tableau de résultats.</p>
<p>PMSISoft PSY Professionnel : voir écran <code>Séjours &gt; Base des séjours</code>, calcul, pour chaque séjour, des variables <code>ordre_episode_soin_continu_ipp</code>, <code>nb_episode_soin_continu_ipp</code>, <code>ordre_episode_soin_concentre_ipp</code>et <code>nb_episode_soin_concentre_ipp</code></p>
<p><a href="http://www.lespmsi.com/scripts-pmsi-r/" target="_blank">Etre tenu au courant de la publication des nouveaux scripts PMSI R</a></p>


</section>

 ]]></description>
  <category>PSY</category>
  <category>IPP</category>
  <guid>https://www.datapmsi.com/posts/psy/script_psy_episode_soin_continu/</guid>
  <pubDate>Mon, 10 Jun 2024 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Casemix basique Intervenant CSARR</title>
  <dc:creator>denis Gustin</dc:creator>
  <link>https://www.datapmsi.com/posts/smr/script_smr_casemix_intervenant/</link>
  <description><![CDATA[ 




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Par type d’intervenant, calcul du nombre d’actes, du nombre de réalisations CSARR et % du nombre d’actes et rapatriement libellé intervenant.</p>
<p>On enrichie en rapatriant le libellé des types d’intervenant via le référentiel <code>csarr_intervenant</code> <sup>1</sup></p>
</section>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">Code</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(refpmsi)</span>
<span id="cb1-3"></span>
<span id="cb1-4">csarr_intervenant <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> refpmsi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">refpmsi</span>(csarr_intervenant)</span>
<span id="cb1-5"></span>
<span id="cb1-6">casemix_csarr_intervenant <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> smr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rhs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>csarr <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-7">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(annee_import,code_csarr,nb_realisation_csarr,code_intervenant_csarr) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-8">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(code_intervenant_csarr) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-9">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_acte_csarr =</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb1-10">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_acte_different_csarr =</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n_distinct</span>(code_csarr),</span>
<span id="cb1-11">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_realisation_csarr =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(nb_realisation_csarr)</span>
<span id="cb1-12">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-13">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(nb_realisation_csarr)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-14">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">percent_realisation_csarr =</span> nb_realisation_csarr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(nb_realisation_csarr)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-15">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(csarr_intervenant, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(code_intervenant_csarr <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> csarr_intervenant_code)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-16">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(code_intervenant_csarr,csarr_intervenant_libelle,nb_acte_csarr,nb_acte_different_csarr,</span>
<span id="cb1-17">                  nb_realisation_csarr,percent_realisation_csarr)</span>
<span id="cb1-18">casemix_csarr_intervenant</span></code></pre></div>
</div>
</section>
<section id="commentaires" class="level2">
<h2 class="anchored" data-anchor-id="commentaires">Commentaires</h2>
<p>Ligne 16 : le <code>dplyr::select()</code> permet de réordonner les variables</p>
<p>PMSISoft SMR Standard : voir écran <code>Codage CSARR &gt; Casemix CSARR &gt; Casemix Intervenant</code></p>
<p><a href="http://www.lespmsi.com/scripts-pmsi-r/" target="_blank">Etre tenu au courant de la publication des nouveaux scripts PMSI R</a></p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Notes de bas de page</h2>

<ol>
<li id="fn1"><p>Documentation du référentiel <a href="https://denisgustin.github.io/refpmsi/articles/csarr.html#csarr-intervenant" target="_blank">csarr_intervenant</a>↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>SMR</category>
  <category>CSARR</category>
  <category>Casemix</category>
  <guid>https://www.datapmsi.com/posts/smr/script_smr_casemix_intervenant/</guid>
  <pubDate>Mon, 10 Jun 2024 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Casemix basique séjours par sévérité</title>
  <dc:creator>denis Gustin</dc:creator>
  <link>https://www.datapmsi.com/posts/mco/script_mco_casemix_sejour_severite/</link>
  <description><![CDATA[ 




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Après avoir calculé les variables <code>nb_jp_rum</code>et <code>nb_jp_sejour</code>, on filtre sur les séjours d’au moins 1 nuitée et on calcule, pour chaque sévérité, le nombre de séjours concernés, le nombre de journées et le % de séjours représenté.</p>
</section>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">Code</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"></span>
<span id="cb1-3">casemix_severite <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mco<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rum<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rum <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-4">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(nas,no_rum,ghm,severite,date_entree_um,date_sortie_um) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-5">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_jp_rum =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.integer</span>(date_sortie_um<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>date_entree_um)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-6">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> nas, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_jp_sejour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(nb_jp_rum)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-7">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(nb_jp_sejour <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-8">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distinct</span>(nas,severite,nb_jp_sejour) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-9">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(severite) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-10">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_sejour_severite =</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb1-11">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_jp_severite =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(nb_jp_sejour)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-12">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(nb_sejour_severite)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-13">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">percent_sejour_severite =</span> nb_sejour_severite<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(nb_sejour_severite))</span>
<span id="cb1-14">casemix_severite</span></code></pre></div>
</div>
</section>
<section id="commentaires" class="level2">
<h2 class="anchored" data-anchor-id="commentaires">Commentaires</h2>
<p>Ligne 8 : on ne retient que des variables liées au séjour pour le <code>dplyr::distinct()</code></p>
<p>PMSISoft MCO Standard : voir écran <code>Séjours &gt; Séjours et classification</code></p>
<p>PMSISoft MCO Professionnel : les 2 variables <code>nb_jp_rum</code> et <code>nb_jp_sejour</code> sont dans <code>mco</code></p>
<p><a href="http://www.lespmsi.com/scripts-pmsi-r/" target="_blank">Etre tenu au courant de la publication des nouveaux scripts PMSI R</a></p>


</section>

 ]]></description>
  <category>MCO</category>
  <category>Casemix</category>
  <guid>https://www.datapmsi.com/posts/mco/script_mco_casemix_sejour_severite/</guid>
  <pubDate>Sun, 09 Jun 2024 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Valorisation T2A des suppléments REA</title>
  <dc:creator>denis Gustin</dc:creator>
  <link>https://www.datapmsi.com/posts/mco/script_mco_valorisation_t2a_supplement_REA/</link>
  <description><![CDATA[ 




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>On suppose qu’on est en ex-DGF</p>
<p>On récupére <code>nb_supplements_rea</code>, variable native des <code>rsa</code> auquel on associe le tarif unitaire du suppléments REA correspondant qui est récupéré dans le référentiel annualisé <code>supplements_mco_public</code> de <code>refpmsi</code></p>
<p>Remarque : <code>annee_sortie_sejour</code>, variable native <code>rsa</code>, = l’année PMSI du séjour, permettant le rapatriement des tarifs correspondant des suppléments</p>
</section>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">Code</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(refpmsi)</span>
<span id="cb1-3"></span>
<span id="cb1-4">supplements_mco_public <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> refpmsi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">refpmsi</span>(supplements_mco_public)</span>
<span id="cb1-5"></span>
<span id="cb1-6">supplements_rea_t2a <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mco<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rsa<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rsa <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-7">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(no_sequentiel_sejour,annee_sortie_sejour,nb_supplements_rea) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-8">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(supplements_mco_public <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(supplement_mco_code <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"REA"</span>),</span>
<span id="cb1-9">                     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(annee_sortie_sejour <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> annee_pmsi)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-10">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">supplements_rea_t2a =</span> nb_supplements_rea<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>supplement_mco_tarif)</span>
<span id="cb1-11">supplements_rea_t2a</span>
<span id="cb1-12"></span>
<span id="cb1-13">total_supplements_rea_t2a <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(supplements_rea_t2a<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>supplements_rea_t2a)</span>
<span id="cb1-14">total_supplements_rea_t2a</span></code></pre></div>
</div>
</section>
<section id="commentaires" class="level2">
<h2 class="anchored" data-anchor-id="commentaires">Commentaires</h2>
<p>PMSISoft MCO Standard : voir écran <code>Recettes T2A MCO &gt; Suppléments</code> qui calcule et présente le casemix des valorisations des suppléments</p>
<p>PMSISoft MCO Professionnel : <code>supplements_rea_t2a</code> déjà calculé dans <code>mco$rsa$rsa_t2a</code></p>
<p><a href="http://www.lespmsi.com/scripts-pmsi-r/" target="_blank">Etre tenu au courant de la publication des nouveaux scripts PMSI R</a></p>


</section>

 ]]></description>
  <category>MCO</category>
  <category>T2A</category>
  <guid>https://www.datapmsi.com/posts/mco/script_mco_valorisation_t2a_supplement_REA/</guid>
  <pubDate>Sun, 09 Jun 2024 22:00:00 GMT</pubDate>
</item>
<item>
  <title>IPP avec plusieurs actes de Réunion le même jour</title>
  <dc:creator>denis Gustin</dc:creator>
  <link>https://www.datapmsi.com/posts/psy/script_psy_nb_jp_multiple_reunion_same_ipp/</link>
  <description><![CDATA[ 




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Pour chaque configuration (ipp,date_acte), on calcule le nombre d’acte de Réunion, puis on ne retient que les configurations avec au moins 2 actes de Réunion.</p>
</section>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">Code</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"></span>
<span id="cb1-3">same_ipp_date_acte <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> psy<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>raa<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>raa <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-4">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(ipp,nature_acte,date_acte) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-5">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(ipp,date_acte,nature_acte),</span>
<span id="cb1-6">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sum_same_ipp_date_acte_nature_acte_R =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(nature_acte <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-7">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(sum_same_ipp_date_acte_nature_acte_R <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>L) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-8">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distinct</span>()</span>
<span id="cb1-9">same_ipp_date_acte</span></code></pre></div>
</div>
</section>
<section id="commentaires" class="level2">
<h2 class="anchored" data-anchor-id="commentaires">Commentaires</h2>
<p>Voir le contrôle Qualité OVALIDE “[1.Q.11.RIPP] : Nombre de journées avec plusieurs actes de réunions pour un même IPP”.<br>
On améliore ici en produisant la variable <code>sum_same_ipp_date_acte_nature_acte_R</code> qui est le nombre d’actes de Réunion</p>
<p>PMSISoft PSY Standard : voir écran <code>Requêtes PSY &gt; Requêtes RAA</code> et la requête <code>Plusieurs actes de réunions pour un même IPP et une même date [1.Q.11.RIPP]</code></p>
<p><a href="http://www.lespmsi.com/scripts-pmsi-r/" target="_blank">Etre tenu au courant de la publication des nouveaux scripts PMSI R</a></p>


</section>

 ]]></description>
  <category>PSY</category>
  <category>RAA</category>
  <guid>https://www.datapmsi.com/posts/psy/script_psy_nb_jp_multiple_reunion_same_ipp/</guid>
  <pubDate>Sun, 09 Jun 2024 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Dépendance physique maximale des séjours HC</title>
  <dc:creator>denis Gustin</dc:creator>
  <link>https://www.datapmsi.com/posts/smr/script_smr_sejour_hc_dependance_physique_maximale/</link>
  <description><![CDATA[ 




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>On calcule la dépendance physique de chaque RHS, puis, par séjour HC, on calcule la dépendance physique maximale parmi le ou les RHS du séjour</p>
</section>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">Code</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"></span>
<span id="cb1-3">sejour_dependance_physique_maximale <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> smr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rhs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rhs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-4">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(nas,no_semaine,type_hospitalisation,</span>
<span id="cb1-5">                  dependance_alimentation,dependance_deplacement,dependance_habillage,dependance_continence) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-6">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(type_hospitalisation <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-7">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dependance_physique_rhs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowSums</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(dependance_alimentation,dependance_deplacement,</span>
<span id="cb1-8">                                                             dependance_habillage,dependance_continence)))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-9">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> nas,</span>
<span id="cb1-10">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dependance_physique_maximale_sejour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(dependance_physique_rhs)</span>
<span id="cb1-11">                  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-12">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distinct</span>(nas,dependance_physique_maximale_sejour)</span>
<span id="cb1-13">sejour_dependance_physique_maximale</span></code></pre></div>
</div>
</section>
<section id="commentaires" class="level2">
<h2 class="anchored" data-anchor-id="commentaires">Commentaires</h2>
<p>Ligne 7-8 : <code>rowSums()</code> pour permettre un calcul ligne à ligne</p>
<p>Démarche identique pour calculer la dépendance cognitive maximale d’un séjour</p>
<p>PMSISoft SMR Standard : information calculée et affichée dans l’écran <code>RHS &gt; Base des RHS &gt; Détail RHS &gt; Dépendance</code></p>
<p>PMSISoft SMR Professionnel : voir aussi écran <code>Séjours &gt; Séjours et dépendance</code></p>
<p><a href="http://www.lespmsi.com/scripts-pmsi-r/" target="_blank">Etre tenu au courant de la publication des nouveaux scripts PMSI R</a></p>


</section>

 ]]></description>
  <category>SMR</category>
  <category>Dépendance</category>
  <guid>https://www.datapmsi.com/posts/smr/script_smr_sejour_hc_dependance_physique_maximale/</guid>
  <pubDate>Sun, 09 Jun 2024 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Actes CCAM avec extension documentaire obligatoire mais absente</title>
  <dc:creator>denis Gustin</dc:creator>
  <link>https://www.datapmsi.com/posts/mco/script_mco_acte_ccam_extension_documentaire_absente/</link>
  <description><![CDATA[ 




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Rappel : l’extension documentaire est obligatoire pour les actes d’anesthésie</p>
<p>On suppose ici que la table des actes CCAM intègre la clé d’identification des RUM (nas,no_rum) permettant de rapprocher les RUM et les actes CCAM</p>
<p>On repère les actes d’anesthésie via activite_ccam == 4</p>
</section>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">Code</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"></span>
<span id="cb1-3">actes_ccam_no_extension_documentaire <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>mco<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rum<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ccam <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-4">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(nas,no_rum,code_ccam,activite_ccam,extension_documentaire_ccam) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-5">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(activite_ccam <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"4"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(extension_documentaire_ccam))</span>
<span id="cb1-6">actes_ccam_no_extension_documentaire</span></code></pre></div>
</div>
</section>
<section id="commentaires" class="level2">
<h2 class="anchored" data-anchor-id="commentaires">Commentaires</h2>
<p>PMSISoft MCO Standard : la clé (nas, no_rum) est incluse par défaut dans <code>mco$rum$ccam</code></p>
<p>PMSISoft MCO Professionnel : écran <code>Codage CCAM &gt; Base des actes CCAM</code> et filtrage de variables <code>activite_ccam Egal à 4 ET extension_documentaire_ccam Est vide</code></p>
<p><a href="http://www.lespmsi.com/scripts-pmsi-r/" target="_blank">Etre tenu au courant de la publication des nouveaux scripts PMSI R</a></p>


</section>

 ]]></description>
  <category>MCO</category>
  <category>CCAM</category>
  <guid>https://www.datapmsi.com/posts/mco/script_mco_acte_ccam_extension_documentaire_absente/</guid>
  <pubDate>Sat, 08 Jun 2024 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Séjours temps complet avec entrée et sortie le même jour</title>
  <dc:creator>denis Gustin</dc:creator>
  <link>https://www.datapmsi.com/posts/psy/script_psy_sejour_temps_complet_entree_sortie_same_sejour/</link>
  <description><![CDATA[ 




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>On sélectionne l’activité RPS en temps complet, puis les RPS avec date_entree_sejour == date_sortie_sejour, puis on ne retient qu’une ligne par séjour.</p>
</section>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">Code</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"></span>
<span id="cb1-3">sejour_selected <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> psy<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-4">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(no_sejour,ipp,forme_activite,nb_jours_presence,date_entree_sejour,date_sortie_sejour) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-5">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(forme_activite <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'01'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'01D'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'01S'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'01P'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'02'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'03'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'04'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'05'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'06'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'07'</span>),</span>
<span id="cb1-6">                  date_entree_sejour <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> date_sortie_sejour) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-7">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distinct</span>(no_sejour,ipp,date_entree_sejour,date_sortie_sejour)</span>
<span id="cb1-8">sejour_selected</span></code></pre></div>
</div>
</section>
<section id="commentaires" class="level2">
<h2 class="anchored" data-anchor-id="commentaires">Commentaires</h2>
<p>Ligne 5 : le vecteur <code>c('01','01D','01S','01P','02','03','04','05','06','07')</code> correspond aux formes d’activité temps complet</p>
<p>Ligne 7 : on ne sélectionne que des variables liées à un séjour</p>
<p>PMSISoft PSY Professionnel : écran <code>Séjours &gt; Base des séjours</code>, filtrage de périmètre <code>Forme d'activité == codes temps_complet</code> et filtrage de variable <code>nb_jp_sejour Egal à 0</code></p>
<p><a href="http://www.lespmsi.com/scripts-pmsi-r/" target="_blank">Etre tenu au courant de la publication des nouveaux scripts PMSI R</a></p>


</section>

 ]]></description>
  <category>PSY</category>
  <category>RPS</category>
  <guid>https://www.datapmsi.com/posts/psy/script_psy_sejour_temps_complet_entree_sortie_same_sejour/</guid>
  <pubDate>Sat, 08 Jun 2024 22:00:00 GMT</pubDate>
</item>
<item>
  <title>RHS CM 08 d’au moins 5 JP avec 0 acte CSARR</title>
  <dc:creator>denis Gustin</dc:creator>
  <link>https://www.datapmsi.com/posts/smr/script_smr_rhs_cm08_no_acte_csarr/</link>
  <description><![CDATA[ 




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Un contrôle qualité classique.</p>
<p>On filtre les RHS sur les 3 variables <code>cm</code>, <code>nb_jp_rhs</code> (à produire) et <code>nb_csarr</code></p>
</section>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">Code</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"></span>
<span id="cb1-3">rhs_selected <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> smr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rhs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rhs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-4">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(annee_import,nas,no_semaine,no_um,cm,jp_we,jp_hors_we,nb_csarr) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-5">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(jp_we,jp_hors_we), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_count</span>(.x,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1"</span>)),</span>
<span id="cb1-6">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_jp_rhs =</span> jp_we<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>jp_hors_we) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-7">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(cm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"08"</span>, nb_jp_rhs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, nb_csarr <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-8">rhs_selected</span></code></pre></div>
</div>
</section>
<section id="commentaires" class="level2">
<h2 class="anchored" data-anchor-id="commentaires">Commentaires</h2>
<p>Ligne 5-6 : voir script “Nombre de JP par RHS”</p>
<p>Avec le script, possibilité de varier en toute liberté les critères de filtrages (age, autres CM/GN/…, autre seuil nb_jp_rhs, ..)</p>
<p>PMSISoft SMR Professionnel : écran <code>RHS &gt; Base des RHS</code>, filtrage de périmètre <code>cm == "08"</code> et filtrage de variable <code>nb_jp_rhs Supérieur ou égal à 5 ET nb_acte_csarr Egal à 0</code></p>
<p><a href="http://www.lespmsi.com/scripts-pmsi-r/" target="_blank">Etre tenu au courant de la publication des nouveaux scripts PMSI R</a></p>


</section>

 ]]></description>
  <category>SMR</category>
  <category>RHS</category>
  <guid>https://www.datapmsi.com/posts/smr/script_smr_rhs_cm08_no_acte_csarr/</guid>
  <pubDate>Sat, 08 Jun 2024 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Casemix basique EDGARX</title>
  <dc:creator>denis Gustin</dc:creator>
  <link>https://www.datapmsi.com/posts/psy/script_psy_casemix_EDGARX/</link>
  <description><![CDATA[ 




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Pour chaque nature d’acte EDGARX du jeu de données, calcul du nombre d’actes, du nombre d’IPP uniques, du nombre de categories professionnelles d’intervenant différentes et du % en nombre d’actes.</p>
</section>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">Code</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"></span>
<span id="cb1-3">raa <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> psy<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>raa<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>raa</span>
<span id="cb1-4"></span>
<span id="cb1-5">casemix_edgarx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> raa <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-6">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(ipp,nature_acte,categorie_professionnelle_intervenant) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-7">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(nature_acte) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-8">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_acte =</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb1-9">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_ipp =</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n_distinct</span>(ipp),</span>
<span id="cb1-10">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_categorie_professionnelle_intervenant =</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n_distinct</span>(categorie_professionnelle_intervenant)</span>
<span id="cb1-11">                     ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-12">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(nb_acte)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-13">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">percent_acte =</span> nb_acte<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(nb_acte), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.after =</span> nb_acte)</span>
<span id="cb1-14">casemix_edgarx</span></code></pre></div>
</div>
</section>
<section id="commentaires" class="level2">
<h2 class="anchored" data-anchor-id="commentaires">Commentaires</h2>
<p>Ligne 12 : on trie sur le nombre descendant de <code>nb_acte</code></p>
<p>Ligne 13 : avec l’argument <code>.after</code>, on positionne directement la variable <code>percent_acte</code> calculée après <code>nb_acte</code></p>
<p>PMSISoft PSY Standard : casemix disponible dans l’écran <code>Actes ambulatoires &gt; Casemix EDGARX &gt; Casemix EDGARX</code></p>
<p><a href="http://www.lespmsi.com/scripts-pmsi-r/" target="_blank">Etre tenu au courant de la publication des nouveaux scripts PMSI R</a></p>


</section>

 ]]></description>
  <category>PSY</category>
  <category>RAA</category>
  <category>EDGARX</category>
  <guid>https://www.datapmsi.com/posts/psy/script_psy_casemix_EDGARX/</guid>
  <pubDate>Fri, 07 Jun 2024 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Rapatriement libellé CSARR</title>
  <dc:creator>denis Gustin</dc:creator>
  <link>https://www.datapmsi.com/posts/smr/script_smr_rapatriement_libelle_csarr/</link>
  <description><![CDATA[ 




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Script ultra-classique permettant de rapatrier un libellé, ici libellé des actes CSARR</p>
<p>A partir du référentiel annualisé des actes CSARR<sup>1</sup>, on créé un référentiel dédoublonné des seuls libellés par acte CSARR. Puis on rattache ce référentiel à la table des actes CSARR produite à partir des “blocs CSARR” des RHS.</p>
</section>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">Code</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(refpmsi)</span>
<span id="cb1-3"></span>
<span id="cb1-4">csarr_code <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> refpmsi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">refpmsi</span>(csarr_code)</span>
<span id="cb1-5"></span>
<span id="cb1-6">csarr_libelle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  csarr_code <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-7">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_head</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> csarr_code) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-8">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(csarr_code,csarr_libelle)</span>
<span id="cb1-9">csarr_libelle</span>
<span id="cb1-10"></span>
<span id="cb1-11">csarr_extend <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> smr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rhs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>csarr <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-12">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(annee_import, code_csarr) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-13">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(csarr_libelle, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(code_csarr <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> csarr_code))</span>
<span id="cb1-14">csarr_extend</span></code></pre></div>
</div>
</section>
<section id="commentaires" class="level2">
<h2 class="anchored" data-anchor-id="commentaires">Commentaires</h2>
<p>Ligne 7 : permet de ne retenir que le dernière libellé actif de l’acte CSARR</p>
<p>PMSISoft SMR Professionnel : variables de libellé, dont comme ici <code>csarr_libelle</code> incluses dans <code>smr</code></p>
<p><a href="http://www.lespmsi.com/scripts-pmsi-r/" target="_blank">Etre tenu au courant de la publication des nouveaux scripts PMSI R</a></p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Notes de bas de page</h2>

<ol>
<li id="fn1"><p>Documentation du référentiel <a href="https://denisgustin.github.io/refpmsi/articles/csarr.html#csarr-code" target="_blank">csarr_code</a>↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>SMR</category>
  <category>CSARR</category>
  <guid>https://www.datapmsi.com/posts/smr/script_smr_rapatriement_libelle_csarr/</guid>
  <pubDate>Fri, 07 Jun 2024 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Nombre de JP d’un séjour MCO</title>
  <dc:creator>denis Gustin</dc:creator>
  <link>https://www.datapmsi.com/posts/mco/script_mco_nb_jp_sejour/</link>
  <description><![CDATA[ 




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Après avoir calculé, par séjour, les variables <code>date_entree_sejour</code> et <code>date_sortie_sejour</code>, on calcule <code>nb_jp_sejour</code></p>
<p>On en profite pour calculer aussi le nombre de RUM par séjour <code>nb_rum_sejour</code></p>
</section>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">Code</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"></span>
<span id="cb1-3">sejour_extended <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mco<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rum<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rum <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-4">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(nas,no_rum,date_entree_um,date_sortie_um) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-5">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(nas) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-6">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_entree_sejour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(date_entree_um), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_sortie_sejour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(date_sortie_um),</span>
<span id="cb1-7">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_jp_sejour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.integer</span>(date_sortie_sejour<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>date_entree_sejour),</span>
<span id="cb1-8">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_rum_sejour =</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()</span>
<span id="cb1-9">                  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-10">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distinct</span>(nas,date_entree_sejour,date_sortie_sejour,nb_jp_sejour,nb_rum_sejour)</span>
<span id="cb1-11">sejour_extended</span></code></pre></div>
</div>
</section>
<section id="commentaires" class="level2">
<h2 class="anchored" data-anchor-id="commentaires">Commentaires</h2>
<p>Ligne 7 : on force en integer le calcul de la différence de dates qui sinon serait une différence en journées, peu pratique à manipuler</p>
<p>PMSISoft MCO Standard : voir écran <code>Séjours &gt; Base des séjours</code></p>
<p>PMSISoft MCO professionnel : variable <code>nb_jp_sejour</code> et <code>nb_rum_sejour</code> présents dans <code>mco</code></p>
<p><a href="http://www.lespmsi.com/scripts-pmsi-r/" target="_blank">Etre tenu au courant de la publication des nouveaux scripts PMSI R</a></p>


</section>

 ]]></description>
  <category>MCO</category>
  <guid>https://www.datapmsi.com/posts/mco/script_mco_nb_jp_sejour/</guid>
  <pubDate>Thu, 06 Jun 2024 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Rapatriement libellé CIM-10 du DP des RPS</title>
  <dc:creator>denis Gustin</dc:creator>
  <link>https://www.datapmsi.com/posts/psy/script_psy_rapatriement_libelle_dp_rps/</link>
  <description><![CDATA[ 




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Script très simple et très classique pour enrichir les données PMSI via le rapatriement des libellés, ici le libellé CIM-10 du DP de chaque RPS du jeu de données, à partir du référentiel <code>cim_libelle</code> <sup>1</sup></p>
</section>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">Code</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(refpmsi)</span>
<span id="cb1-3"></span>
<span id="cb1-4">cim_libelle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> refpmsi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">refpmsi</span>(cim_libelle)</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># everything() dans le select() est une façon de sélectionner toutes les variables natives du rps, dont la variable dp </span></span>
<span id="cb1-7">rps_extended <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> psy<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-8">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-9">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(cim_libelle <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(cim_code, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dp_libelle =</span> cim_libelle), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(dp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> cim_code))</span>
<span id="cb1-10">rps_extended</span></code></pre></div>
</div>
</section>
<section id="commentaires" class="level2">
<h2 class="anchored" data-anchor-id="commentaires">Commentaires</h2>
<p>Ligne 8 : <code>everything()</code> est pour <code>tidyselect::everything()</code> sachant que le package <code>tidyselect::</code> est chargé indirectement via le <code>dplyr</code></p>
<p>Ligne 9 : on profite du <code>dplyr::select()</code> pour renommer <code>cim_libelle</code> en <code>dp_libelle</code> plus cohérent</p>
<p>Ligne 9 : le <code>dplyr::left_join()</code> ajoute <code>dp_libelle</code> en dernière position</p>
<p>PMSISoft PSY Standard : voir écran <code>RPS &gt; Base des RPS</code></p>
<p>PMSISoft PSY Professionnel : <code>dp_libelle</code> est dans liste des variables de <code>psy$rps$rps</code></p>
<p><a href="http://www.lespmsi.com/scripts-pmsi-r/" target="_blank">Etre tenu au courant de la publication des nouveaux scripts PMSI R</a></p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Notes de bas de page</h2>

<ol>
<li id="fn1"><p>documentation du référentiel <a href="https://denisgustin.github.io/refpmsi/articles/cim.html#cim-libell%C3%A9" target="_blank">cim_libelle</a>↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>PSY</category>
  <category>RPS</category>
  <category>CIM</category>
  <guid>https://www.datapmsi.com/posts/psy/script_psy_rapatriement_libelle_dp_rps/</guid>
  <pubDate>Thu, 06 Jun 2024 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Nombre de JP par RHS</title>
  <dc:creator>denis Gustin</dc:creator>
  <link>https://www.datapmsi.com/posts/smr/script_smr_nombre_jp_rhs/</link>
  <description><![CDATA[ 




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Pour chaque RHS, on compte le nombre de “1” dans les variables natives <code>jp_hors_we</code> et <code>jp_we</code>, en écrasant leur valeur initiale (suite de “0” et de “1”) par la valeur calculée, puis on additionne ces 2 variables.</p>
</section>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">Code</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"></span>
<span id="cb1-3">rhs_extend <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> smr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rhs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rhs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-4">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(nas,no_semaine,no_um,jp_we,jp_hors_we) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-5">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(jp_we,jp_hors_we), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_count</span>(.x,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1"</span>)),</span>
<span id="cb1-6">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb_jp_rhs =</span> jp_we<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>jp_hors_we)</span>
<span id="cb1-7">rhs_extend</span></code></pre></div>
</div>
</section>
<section id="commentaires" class="level2">
<h2 class="anchored" data-anchor-id="commentaires">Commentaires</h2>
<p>Ligne 5 : utilisation ultra-classique de la fonction <code>àcross()</code> pour appliquer un même traitement à plusieurs variables en une seule ligne</p>
<p>PMSISoft SMR Standard : voir écran <code>RHS &gt; Base des RHS</code></p>
<p>PMSISoft SMR Professionnel : variable <code>nb_jp_rhs</code> présent dans <code>smr</code></p>
<p><a href="http://www.lespmsi.com/scripts-pmsi-r/" target="_blank">Etre tenu au courant de la publication des nouveaux scripts PMSI R</a></p>


</section>

 ]]></description>
  <category>SMR</category>
  <category>RHS</category>
  <guid>https://www.datapmsi.com/posts/smr/script_smr_nombre_jp_rhs/</guid>
  <pubDate>Thu, 06 Jun 2024 22:00:00 GMT</pubDate>
</item>
</channel>
</rss>
